@inherits LayoutComponentBase

@inject ThemeService Theme
@inject MoodNest.Components.Services.PinAuthService Auth
@inject NavigationManager Nav

<!--
    Root layout container.
    Applies dynamic theme class (light / dark) to the entire application.
-->
<div class="@Theme.CssClass layout-root">

    <!-- ===============================
         SIDEBAR NAVIGATION
         =============================== -->
    <aside class="sidebar">
        <!-- Reusable navigation component -->
        <TestNav />
    </aside>

    <!-- ===============================
         MAIN LAYOUT AREA
         =============================== -->
    <div class="layout-main">

        <!-- ===============================
             TOP HEADER BAR
             =============================== -->
        <header class="topbar">

            <!-- Left section (reserved for page titles / breadcrumbs) -->
            <div class="topbar-left">
                <span class="page-title"></span>
            </div>

            <!-- Right section (actions & controls) -->
            <div class="topbar-right">

                <!-- Theme toggle button -->
                <button class="icon-btn"
                        title="Toggle theme"
                        @onclick="ToggleTheme">
                    @(Theme.IsDark ? "â˜€ï¸" : "ğŸŒ™")
                </button>

                <!-- Lock application button -->
                <button class="icon-btn"
                        title="Lock"
                        @onclick="LockApp">
                    ğŸ”’
                </button>
            </div>

        </header>

        <!-- ===============================
             PAGE CONTENT PLACEHOLDER
             =============================== -->
        <main class="content-area">
            @Body
        </main>

        <!-- ===============================
             FOOTER
             =============================== -->
        <footer class="footer">
            <p>Â© 2025 MoodNest Â· CS6004 Application Development</p>
        </footer>

    </div>

</div>

@code {

    /// <summary>
    /// Toggles between light and dark themes.
    /// Triggers a UI refresh to immediately apply the theme change.
    /// </summary>
    private void ToggleTheme()
    {
        Theme.Toggle();
        StateHasChanged();
    }

    /// <summary>
    /// Locks the application by clearing authentication state
    /// and redirecting the user to the lock screen.
    /// </summary>
    private void LockApp()
    {
        Auth.Lock();
        Nav.NavigateTo("/", replace: true);
    }
}
